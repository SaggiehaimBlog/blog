<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8080&amp;path=livereload" data-no-instant defer></script>
  <title>Build Gui for Powershell - Saggie Haim - Automate Everything</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Hey everyone! Today I want to talk about GUI for PowerShell. You probably wonder why? PowerShell is all about the CLI and moving away from the GUI. but sometimes, a GUI for our scripts can be very useful.
Every Company has HelpDesk team, other System Admins that don‚Äôt know PowerShell at all, or non-technical staff. While I will encourage them to learn, I can‚Äôt make them. As a result, I need to provide them with a GUI for some of the tools or solutions."
/>
<meta
  name="keywords"
  content="PowerShell GUI, PowerShell GUI scripting, Create GUI PowerShell, PowerShell Windows Forms, PowerShell WPF, GUI automation PowerShell, PowerShell GUI tutorial, PowerShell script with GUI, PowerShell UI design, Build PowerShell interface, PowerShell GUI example, PowerShell graphical interface, PowerShell GUI tools, PowerShell XAML, PowerShell GUI builder"
/>
<meta name="robots" content="noodp" />
<meta property="og:url" content="//localhost:8080/posts/build-gui-for-powershell/">
  <meta property="og:site_name" content="Saggie Haim - Automate Everything">
  <meta property="og:title" content="Build Gui for Powershell">
  <meta property="og:description" content="Learn how to build PowerShell GUI tools with a real life example">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2019-02-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2019-02-20T00:00:00+00:00">
    <meta property="article:tag" content="PowerShell">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Build Gui for Powershell">
  <meta name="twitter:description" content="Learn how to build PowerShell GUI tools with a real life example">


<link rel="canonical" href="//localhost:8080/posts/build-gui-for-powershell/" />

<link rel="shortcut icon" href="/favicon.ico" />
<link rel="stylesheet" href="/css/index.e2def390bae69ff2f50c7329955414852291d8c31d95f9a96f9f4c54c96220f7.css">





  






  
  

</head>
<body class="flex flex-col min-h-screen w-full bg-slate-50 dark:bg-gray-800">
    
<div class="fixed right-0 top-0 z-50 flex items-center justify-center bg-gray-200 p-2 text-sm uppercase text-black sm:bg-red-200 md:bg-yellow-200 lg:bg-green-200 xl:bg-blue-200 2xl:bg-pink-200">
  <span class="block sm:hidden">all</span>
  <span class="hidden sm:block md:hidden">sm</span>
  <span class="hidden md:block lg:hidden">md</span>
  <span class="hidden lg:block xl:hidden">lg</span>
  <span class="hidden xl:block 2xl:hidden">xl</span>
  <span class="hidden 2xl:block">2xl</span>
</div>

  <header class="flex flex-none justify-center z-10 bg-slate-50 dark:bg-gray-800 sticky top-0">
    <div class="flex flex-row gap justify-between w-full max-w-4xl lg:max-w-5xl my-4">
  <div class="flex-none ml-2  md:ml-0">
    <a href="/" class="">
      <img class="h-13 w-12" src="/white_logo.png" alt="logo">
    </a>
  </div>
  <div class="flex-none mx-1"></div>
  <div class="flex-none">
    



<nav class="h-full static">
  <button id="navbar-menu-toggle" type="button" class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg md:hidden" aria-controls="navbar-menu" aria-expanded="false">
    <span class="sr-only">Open main menu</span>
    <i class="w-8 h-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 6l16 0" />
  <path d="M4 12l16 0" />
  <path d="M4 18l16 0" />
</svg>

    </i>
  </button>
  <div class="absolute md:static top-16 left-0 right-0 z-50 hidden w-full md:block md:w-auto" id="navbar-menu">
    <ul class="flex flex-col mx-2 md:mx-0 md:flex-row md:border-0 rounded-sm md:rounded-full px-3 text-base font-medium text-slate-800 dark:text-slate-200 shadow-lg bg-white dark:bg-gray-600 shadow-slate-800/5 dark:shadow-slate-200/5 ring-1 ring-slate-900/5 dark:ring-slate-100/5">
    
        <li id="home" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400 text-blue-600 dark:text-blue-200"
            href="/posts/" title="Home">Home</a>
        </li>
      
    
        <li id="about" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400"
            href="/about/" title="About">About</a>
        </li>
      
    
        <li id="contact" class="">
          <a class="block px-3 py-3 hover:text-blue-600  dark:hover:text-blue-400"
            href="/contact/" title="Contact">Contact</a>
        </li>
      
    
    </ul>
  </div>
</nav>


  </div>
  <div class="flex-1"></div>

  
  <div class="flex-none mx-1"></div>
  
  <div class="flex-none md:hidden">
    <a href=/search/ class="inline-flex items-center p-2 text-sm text-slate-800 dark:text-slate-200 rounded-lg" aria-controls="navbar-menu" aria-expanded="false">
      <span class="sr-only">Search</span>
      <i class="w-8 h-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
    <path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" />
    <path d="M21 21l-6 -6" />
</svg>

      </i>
    </a>
  </div>
  <div class="darkmode-toggle flex flex-none mr-2 md:mr-0">
    <label for="darkmode-toggle" class="flex items-center px-3 cursor-pointer rounded-full bg-gray-100 dark:bg-gray-600" title="Toggle dark mode">
      <input name="darkmode-toggle" id="darkmode-toggle" type="checkbox" class="sr-only peer" aria-label="Toggle dark mode">
      <div class="group flex flex-row gap-1 justify-center h-8 px-1 rounded-full bg-white dark:bg-gray-700">
        <i class="h-6 w-6 flex-none rounded-full bg-yellow-400 place-self-center peer-checked:group-[]:invisible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brightness-down" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path>
   <path d="M12 5l0 .01"></path>
   <path d="M17 7l0 .01"></path>
   <path d="M19 12l0 .01"></path>
   <path d="M17 17l0 .01"></path>
   <path d="M12 19l0 .01"></path>
   <path d="M7 17l0 .01"></path>
   <path d="M5 12l0 .01"></path>
   <path d="M7 7l0 .01"></path>
</svg>

        </i>
        <i class="h-6 w-6 flex-none rounded-full place-self-center invisible peer-checked:group-[]:visible">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon-stars" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
   <path d="M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2"></path>
   <path d="M19 11h2m-1 -1v2"></path>
</svg>

        </i>
      </div>
    </label>
  </div>
</div>

  </header>
  <main class="flex flex-auto justify-center">
    
<div class="w-full max-w-4xl lg:max-w-5xl">
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-gray-700">
    <div>
      <a href="/posts/build-gui-for-powershell/">
        <picture>
    <source type="image/webp" srcset="/posts/build-gui-for-powershell/images/pwshguicover_hu2b50fc88244377a6063f77929db67418_65657_960x0_resize_q75_h2_box.webp 960w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="/posts/build-gui-for-powershell/images/pwshguicover_hu2b50fc88244377a6063f77929db67418_65657_960x0_resize_q75_box.jpg 960w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="w-full object-cover h-36 md:h-48 xl:h-60" src="/posts/build-gui-for-powershell/images/pwshguicover_hu2b50fc88244377a6063f77929db67418_65657_640x0_resize_q75_box.jpg" width="977" height="720" alt="Build Gui for Powershell" title="Build Gui for Powershell" loading="lazy" />
  </picture>
      </a>
    </div>
    <div class="flex flex-col gap-y-3 p-6">
      <h1 class="text-4xl font-semibold text-slate-800 dark:text-slate-100">
        <a href="/posts/build-gui-for-powershell/">Build Gui for Powershell</a>
      </h1>

      
      <h2 class="my-4 text-large text-slate-600 dark:text-slate-300">
        Learn how to build PowerShell GUI tools with a real life example
      </h2>
      
      
  <ul class="flex flex-row flex-wrap text-slate-500 dark:text-slate-300">
    
      
      <li>
        <a href="/categories/powershell/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          PowerShell
        </a>
      </li>
      
      <li>
        <a href="/categories/automation/"
          class="text-sm mr-2 px-2 py-1 rounded border border-emerald-800 bg-emerald-800 text-slate-50">
          Automation
        </a>
      </li>
      
    
    
      
      <li>
        <a href="/tags/powershell/"
          class="flex flex-row text-sm mr-2 py-1">
          <i class="h-5 w-5 flex-none">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M5 9l14 0"></path>
   <path d="M5 15l14 0"></path>
   <path d="M11 4l-4 16"></path>
   <path d="M17 4l-4 16"></path>
</svg>

          </i>
          <span class="ml-0">PowerShell</span>
        </a>
      </li>
      
    
  </ul>


      <div class="flex flex-col gap-y-1 md:flex-row md:gap-y-0 md:gap-x-4 text-slate-500 dark:text-slate-300">
  
  
  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z"></path>
   <path d="M16 3v4"></path>
   <path d="M8 3v4"></path>
   <path d="M4 11h16"></path>
   <path d="M11 15h1"></path>
   <path d="M12 15v3"></path>
</svg>

    </i>
    <time datetime="2019-02-20T00:00:00&#43;00:00">
      2019-02-20
    </time>
  </div>

  <div class="flex flex-row text-base gap-x-1">
    <i class="h-6 w-6 flex-none">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hourglass-high" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M6.5 7h11"></path>
   <path d="M6 20v-2a6 6 0 1 1 12 0v2a1 1 0 0 1 -1 1h-10a1 1 0 0 1 -1 -1z"></path>
   <path d="M6 4v2a6 6 0 1 0 12 0v-2a1 1 0 0 0 -1 -1h-10a1 1 0 0 0 -1 1z"></path>
</svg>

    </i>
    <span>
      11 minutes to read
    </span>
  </div>
</div>


      
        
        <section class="prose prose-slate dark:prose-invert w-full max-w-4xl lg:max-w-5xl mt-6">
          <h2>Table of Contents</h2>
          <aside><nav id="TableOfContents">
  <ul>
    <li><a href="#windows-presentation-foundation--wpf">Windows Presentation Foundation ‚Äì WPF</a></li>
    <li><a href="#windows-forms--winforms">Windows Forms ‚Äì WinForms</a></li>
    <li><a href="#the-task">The task</a></li>
    <li><a href="#the-gui-side">The GUI side</a>
      <ul>
        <li><a href="#gui-code-overview">GUI code overview</a></li>
        <li><a href="#global-configuration">Global configuration</a></li>
        <li><a href="#the-service-account-name">The Service Account Name</a></li>
        <li><a href="#manager-employee-id">Manager Employee ID</a></li>
        <li><a href="#creator-employee-id">Creator Employee ID</a></li>
        <li><a href="#description">Description</a></li>
        <li><a href="#create-account-button">Create Account button</a></li>
        <li><a href="#status-bar">Status Bar</a></li>
        <li><a href="#create-the-form">Create the form</a></li>
        <li><a href="#add-events">Add events</a></li>
        <li><a href="#wrapping-up">wrapping up</a></li>
      </ul>
    </li>
    <li><a href="#the-powershell-side">The PowerShell side</a>
      <ul>
        <li><a href="#get-employee-by-employeeid">Get Employee by employeeID</a></li>
        <li><a href="#generate-a-password">Generate a Password</a></li>
        <li><a href="#create-mail-reports">Create Mail Reports</a></li>
        <li><a href="#create-new-service-account">Create new Service account</a></li>
        <li><a href="#the-script">The Script</a></li>
        <li><a href="#content-validation">Content validation</a></li>
        <li><a href="#creating-the-service-account">Creating the Service Account</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></aside>
        </section>
        
      

      <article class="mt-6 w-full max-w-4xl lg:max-w-5xl prose prose-slate dark:prose-invert prose-quoteless post-content">
        <p>Hey everyone! Today I want to talk about GUI for PowerShell.
You probably wonder why? PowerShell is all about the CLI and moving away from the GUI.
but sometimes, a GUI for our scripts can be very useful.</p>
<p>Every Company has HelpDesk team, other System Admins that don‚Äôt know PowerShell at all, or non-technical staff.
While I will encourage them to learn, I can‚Äôt make them.
As a result, I need to provide them with a GUI for some of the tools or solutions.</p>
<p><div class="not-prose">
<picture>
    <source type="image/webp" srcset="/posts/build-gui-for-powershell/images/oldladymeme_hu9e751e59096b4ca965c7fec77afe35c5_30560_320x0_resize_q75_h2_box.webp 320w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="/posts/build-gui-for-powershell/images/oldladymeme_hu9e751e59096b4ca965c7fec77afe35c5_30560_320x0_resize_q75_box.jpg 320w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="h-auto max-w-full rounded-lg" src="/posts/build-gui-for-powershell/images/oldladymeme_hu9e751e59096b4ca965c7fec77afe35c5_30560_640x0_resize_q75_box.jpg" width="428" height="336" alt=" " title=" " loading="lazy" />
  </picture><p class="text-sm text-center text-slate-500 dark:text-slate-300">Old Lady meme</p>
</div>
</p>
<p>First of all, let‚Äôs talk about PowerShell GUI.
In fact, There is no such thing ‚ÄúPowerShell GUI‚Äù in the PowerShell world, The GUI part is part of the .NET world (which PowerShell built upon).
There are Two main ways to provide GUI for our scripts and both of them related to .NET:</p>
<h2 id="windows-presentation-foundation--wpf">Windows Presentation Foundation ‚Äì WPF</h2>
<p>WPF is a subsystem of the .NET framework and can be used for rendering user interfaces in Windows-based applications.
Due to the dependency of .NET, WPF is supported only in Windows-based clients.</p>
<h2 id="windows-forms--winforms">Windows Forms ‚Äì WinForms</h2>
<p>Similarity to WPF, WinForms is also part of the .NET framework.
WinForms is a graphical (GUI) class library included as a part of the Microsoft .NET Framework or Mono Framework, and also supported only in Windows-based clients.</p>
<p>Soon with .NET Core, we will see solutions for Linux GUI also üòÉ</p>
<h2 id="the-task">The task</h2>
<p>In my company, we use Service Accounts, those accounts are used to run Business Application Services, Tasks and more.
They can also be used for developers teams, needing the account for the systems tests run and so.
In order to create a Service Account, one shall follow the following guidelines:</p>
<ul>
<li>SamAccountName must start with: Srvc</li>
<li>Must have a manager (employee who takes responsibility for the account if any anomaly or issue detected)</li>
<li>Account must have the following description ‚ÄúService Account for <code>&lt;Account purpose&gt;</code>‚Äù</li>
<li>Account office attribute: Must include ‚ÄúManaged by <code>&lt;Employee name&gt; (&lt;Employee ID&gt;)</code></li>
</ul>
<p>Seems like a easy task right? but when you have a team that needs to do it, a few times a week, it becomes error prone quite fast.
So how can we provide a solution?</p>
<h2 id="the-gui-side">The GUI side</h2>
<p>I want to provide the team with a tool that will get the information and perform the creation automatically.
In addition, I want to send emails for confirmations and audit.
First, I like to start with the GUI design, it will make it easier to know what functions I need to build in my script.
For small tasks like this, I love to use <a href="https://poshgui.com/" target="_blank" rel="noopener">POSHGUI</a>
, it‚Äôs a web tool that let you build Winforms GUI for PowerShell in minutes.</p>
<p><div class="not-prose">
<picture>
    <source type="image/webp" srcset="/posts/build-gui-for-powershell/images/ServiceAccountGUI_hu2fed76e5a70c2989ea3d298226af795f_21585_320x0_resize_q75_h2_box.webp 320w, /posts/build-gui-for-powershell/images/ServiceAccountGUI_hu2fed76e5a70c2989ea3d298226af795f_21585_640x0_resize_q75_h2_box.webp 640w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <source type="image/jpeg" srcset="/posts/build-gui-for-powershell/images/ServiceAccountGUI_hu2fed76e5a70c2989ea3d298226af795f_21585_320x0_resize_q75_box.jpg 320w, /posts/build-gui-for-powershell/images/ServiceAccountGUI_hu2fed76e5a70c2989ea3d298226af795f_21585_640x0_resize_q75_box.jpg 640w" sizes="(min-width: 1024px) 100vw, 50vw" />
    <img class="h-auto max-w-full rounded-lg" src="/posts/build-gui-for-powershell/images/ServiceAccountGUI_hu2fed76e5a70c2989ea3d298226af795f_21585_640x0_resize_q75_box.jpg" width="747" height="379" alt="My Service Account creation GUI" title="My Service Account creation GUI" loading="lazy" />
  </picture><p class="text-sm text-center text-slate-500 dark:text-slate-300">Image of my Service Account creation GUI</p>
</div>
</p>
<p>I won‚Äôt include the ‚ÄúOffice‚Äù attribute as I have all the information needed to update it myself.</p>
<h3 id="gui-code-overview">GUI code overview</h3>
<p>First, we need to Add-Type, this cmdlet adds a .NET class to our Powershell Session.
Then we enable visual styles to our form, this adds theme style.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>Add-Type -AssemblyName System.Windows.Forms
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">System.Windows.Forms.Application</span>]::EnableVisualStyles()
</span></span></code></pre></div><h3 id="global-configuration">Global configuration</h3>
<p>Secondly, we need to define global properties, including the form itself, the size of the window, title and more:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#region begin GUI{ </span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$Form = New-Object system.Windows.Forms.Form <span style="color:#75715e"># Create a form</span>
</span></span><span style="display:flex;"><span>$Form.ClientSize = <span style="color:#e6db74">&#39;495,216&#39;</span> <span style="color:#75715e"># Window size</span>
</span></span><span style="display:flex;"><span>$Form.text = <span style="color:#e6db74">&#34;Service Account Creator&#34;</span> <span style="color:#75715e"># Window title</span>
</span></span><span style="display:flex;"><span>$Form.TopMost = $false <span style="color:#75715e">#Always on top?</span>
</span></span><span style="display:flex;"><span>$Form.StartPosition = <span style="color:#e6db74">&#34;CenterScreen&#34;</span> <span style="color:#75715e">#loads the window in the center of the screen</span>
</span></span><span style="display:flex;"><span>$Form.FormBorderStyle = <span style="color:#e6db74">&#39;Fixed3D&#39;</span> <span style="color:#75715e">#modifies the window border</span>
</span></span></code></pre></div><h3 id="the-service-account-name">The Service Account Name</h3>
<p>This ‚ÄòTextBox‚Äô will be the SamAccountName of the user, as I said before, it must start with Srvc so I typed it in by default as a reminder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$SAccountName = New-Object system.Windows.Forms.TextBox <span style="color:#75715e"># Declare the Lable</span>
</span></span><span style="display:flex;"><span>$SAccountName.multiline = $false
</span></span><span style="display:flex;"><span>$SAccountName.text = <span style="color:#e6db74">&#34;Srvc&#34;</span> <span style="color:#75715e"># Default string</span>
</span></span><span style="display:flex;"><span>$SAccountName.width = <span style="color:#ae81ff">309</span> 
</span></span><span style="display:flex;"><span>$SAccountName.height = <span style="color:#ae81ff">20</span> 
</span></span><span style="display:flex;"><span>$SAccountName.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">25</span>)
</span></span><span style="display:flex;"><span>$SAccountName.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$AccountName = New-Object system.Windows.Forms.Label
</span></span><span style="display:flex;"><span>$AccountName.text = <span style="color:#e6db74">&#34;Service Account Name&#34;</span>
</span></span><span style="display:flex;"><span>$AccountName.AutoSize = $true
</span></span><span style="display:flex;"><span>$AccountName.width = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>$AccountName.height = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>$AccountName.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">25</span>)
</span></span><span style="display:flex;"><span>$AccountName.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span></code></pre></div><h3 id="manager-employee-id">Manager Employee ID</h3>
<p>In our company the Employee ID is the unique identifier in the Active Directory, we will use it to find the correct employee.
we will use it to fill in the information in the service account and to send him a confirmation mail.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$ManagerEmployee = New-Object system.Windows.Forms.Label
</span></span><span style="display:flex;"><span>$ManagerEmployee.text = <span style="color:#e6db74">&#34;Manger Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>$ManagerEmployee.AutoSize = $true
</span></span><span style="display:flex;"><span>$ManagerEmployee.width = <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>$ManagerEmployee.height = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>$ManagerEmployee.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">55</span>)
</span></span><span style="display:flex;"><span>$ManagerEmployee.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$ManagerEmployeeID = New-Object system.Windows.Forms.TextBox
</span></span><span style="display:flex;"><span>$ManagerEmployeeID.multiline = $false
</span></span><span style="display:flex;"><span>$ManagerEmployeeID.width = <span style="color:#ae81ff">309</span>
</span></span><span style="display:flex;"><span>$ManagerEmployeeID.height = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>$ManagerEmployeeID.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">55</span>)
</span></span><span style="display:flex;"><span>$ManagerEmployeeID.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span></code></pre></div><h3 id="creator-employee-id">Creator Employee ID</h3>
<p>Same as the Manager Employee ID, this time for the creator employee ID, we will use this to audit the process and send him a confirmation mail.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$CreatorEmployee = New-Object system.Windows.Forms.Label
</span></span><span style="display:flex;"><span>$CreatorEmployee.text = <span style="color:#e6db74">&#34;Creator Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>$CreatorEmployee.AutoSize = $true
</span></span><span style="display:flex;"><span>$CreatorEmployee.width = <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>$CreatorEmployee.height = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>$CreatorEmployee.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">82</span>)
</span></span><span style="display:flex;"><span>$CreatorEmployee.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$CreatorEmployeeID = New-Object system.Windows.Forms.TextBox
</span></span><span style="display:flex;"><span>$CreatorEmployeeID.multiline = $false
</span></span><span style="display:flex;"><span>$CreatorEmployeeID.width = <span style="color:#ae81ff">309</span>
</span></span><span style="display:flex;"><span>$CreatorEmployeeID.height = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>$CreatorEmployeeID.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">82</span>)
</span></span><span style="display:flex;"><span>$CreatorEmployeeID.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span></code></pre></div><h3 id="description">Description</h3>
<p>What is the purpose of this Service account, same as service account name, it must start with ‚ÄúService Account for ‚Äù</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Description = New-Object system.Windows.Forms.Label
</span></span><span style="display:flex;"><span>$Description.text = <span style="color:#e6db74">&#34;Description&#34;</span>
</span></span><span style="display:flex;"><span>$Description.AutoSize = $true
</span></span><span style="display:flex;"><span>$Description.width = <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>$Description.height = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>$Description.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">110</span>)
</span></span><span style="display:flex;"><span>$Description.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>$TDescription = New-Object system.Windows.Forms.TextBox
</span></span><span style="display:flex;"><span>$TDescription.multiline = $false
</span></span><span style="display:flex;"><span>$TDescription.text = <span style="color:#e6db74">&#34;Service Account For&#34;</span>
</span></span><span style="display:flex;"><span>$TDescription.width = <span style="color:#ae81ff">309</span>
</span></span><span style="display:flex;"><span>$TDescription.height = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>$TDescription.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">156</span>, <span style="color:#ae81ff">110</span>)
</span></span><span style="display:flex;"><span>$TDescription.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span></code></pre></div><h3 id="create-account-button">Create Account button</h3>
<p>Every program needs an action button. Here we need only one button.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Create = New-Object system.Windows.Forms.Button
</span></span><span style="display:flex;"><span>$Create.text = <span style="color:#e6db74">&#34;Create Account&#34;</span>
</span></span><span style="display:flex;"><span>$Create.width = <span style="color:#ae81ff">111</span>
</span></span><span style="display:flex;"><span>$Create.height = <span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>$Create.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">154</span>)
</span></span><span style="display:flex;"><span>$Create.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span></code></pre></div><h3 id="status-bar">Status Bar</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$StatusBar = New-Object System.Windows.Forms.Label
</span></span><span style="display:flex;"><span>$StatusBar.width = <span style="color:#ae81ff">495</span>
</span></span><span style="display:flex;"><span>$StatusBar.height = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>$StatusBar.location = New-Object System.Drawing.Point(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">192</span>)
</span></span><span style="display:flex;"><span>$StatusBar.Font = <span style="color:#e6db74">&#39;Microsoft Sans Serif,10&#39;</span>
</span></span><span style="display:flex;"><span>$StatusBar.Text = <span style="color:#e6db74">&#39;Ready&#39;</span>
</span></span><span style="display:flex;"><span>$StatusBar.Enabled = $true
</span></span></code></pre></div><h3 id="create-the-form">Create the form</h3>
<p>After we specify each component in our form, we need to invoke it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$Form.controls.AddRange(@($SAccountName, $AccountName, $ManagerEmployee, $ManagerEmployeeID, $CreatorEmployee, $CreatorEmployeeID, $Description, $TDescription, $Create, $StatusBar))
</span></span></code></pre></div><h3 id="add-events">Add events</h3>
<p>After we have the form, we need to add an event, there are plenty events to execute and you can explore them in POSHGUI, here in our example we need to add click action to our button, we will put there the code we want to execute each time we press the button.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#region gui events {</span>
</span></span><span style="display:flex;"><span>$Create.Add_Click( {
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The script that will execute each time we click the button</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endregion events }</span>
</span></span></code></pre></div><h3 id="wrapping-up">wrapping up</h3>
<p>Finally, we need to close the GUI section and invoke the ShowDialog() method to display our form</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#endregion GUI }</span>
</span></span><span style="display:flex;"><span>[<span style="color:#66d9ef">void</span>]$Form.ShowDialog()
</span></span></code></pre></div><h2 id="the-powershell-side">The PowerShell side</h2>
<p>The GUI we have is nice, but it doing nothing.
In order for the GUI to do something when we click on the button ‚ÄúCreate Account‚Äù we need to add our PowerShell script in the button click action.
But before we do it we need to write some helper functions for our script:</p>
<h3 id="get-employee-by-employeeid">Get Employee by employeeID</h3>
<p>The first function will help us get the information we need for the Manager and Creator employees, it will look for the employee ID in the Active Directory and return the user if found, or $false if not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Get-account ($EmployeeID) {
</span></span><span style="display:flex;"><span>    $user = Get-ADUser -Properties EmployeeID, EmailAddress -Filter {EmployeeID <span style="color:#f92672">-eq</span> $EmployeeID} | Select-Object Name, EmailAddress, EmployeeID
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ($null <span style="color:#f92672">-eq</span> $user) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $false
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $user
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="generate-a-password">Generate a Password</h3>
<p>Then we need to be able to generate passwords, to do that I‚Äôm using my <a href="https://github.com/SaggiehaimBlog/PS-NewPassword" target="_blank" rel="noopener">New Password Generator</a>
 core function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e"># Create a new password</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> new-Password() {
</span></span><span style="display:flex;"><span>    $inputRange = <span style="color:#ae81ff">48</span>.<span style="color:#ae81ff">.122</span>
</span></span><span style="display:flex;"><span>    $inputRange += <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">35</span>
</span></span><span style="display:flex;"><span>    $exclude = <span style="color:#ae81ff">91</span>.<span style="color:#ae81ff">.96</span>
</span></span><span style="display:flex;"><span>    $exclude += <span style="color:#ae81ff">58</span>.<span style="color:#ae81ff">.63</span>
</span></span><span style="display:flex;"><span>    $randomRange = $inputRange | Where-Object { $exclude <span style="color:#f92672">-notcontains</span> $_}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ($i = <span style="color:#ae81ff">0</span>; $i <span style="color:#f92672">-lt</span> <span style="color:#ae81ff">12</span>; $i++) {
</span></span><span style="display:flex;"><span>        $rnd = (Get-Random -InputObject $randomRange) 
</span></span><span style="display:flex;"><span>        $char = [<span style="color:#66d9ef">char</span>]$rnd
</span></span><span style="display:flex;"><span>        $pass += $char
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $pass
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="create-mail-reports">Create Mail Reports</h3>
<p>Another task we need to perform is to send emails with the account information.
I‚Äôm creating two emails, but it‚Äôs up to you to decide.
I create one mail for the user creator and the user manager, with the account info and password.
Second mail is for the security team audit, simple mail that state that account has been created, with all the information except the password.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">## Send Mail on Complition</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> Send-DoneEmail ($Creatoruser, $Manageruser, $NewUser, $password) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">##configure SMTP Settings</span>
</span></span><span style="display:flex;"><span>    $From = <span style="color:#e6db74">&#34;Admin@saggiehaim.met&#34;</span>
</span></span><span style="display:flex;"><span>    $SMTPServer = <span style="color:#e6db74">&#34;saggiehaim.net&#34;</span>
</span></span><span style="display:flex;"><span>    $SMTPPort = <span style="color:#e6db74">&#34;25&#34;</span>
</span></span><span style="display:flex;"><span>    $AdministratorsSMTPAddress = <span style="color:#e6db74">&#34;contact@saggiehaim.net&#34;</span>
</span></span><span style="display:flex;"><span>    $usersSMTPAddress = $Manageruser.EmailAddress, $Creatoruser.EmailAddress
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Create email and send it to Users.</span>
</span></span><span style="display:flex;"><span>    $SubjectAdministrators = <span style="color:#e6db74">&#34;New Service Account Has been created for you&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD = <span style="color:#e6db74">&#34;Hello,&lt;br&gt;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;New Service account has been created for you by: &#34;</span> + $Creator.name + <span style="color:#e6db74">&#34;&lt;br&gt;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service account Name:&lt;/b&gt; &#34;</span> + $NewUser.SamAccountName + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span> 
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service account Password:&lt;/b&gt; &#34;</span> + $password + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;You will be asked to change the password after first logon&lt;/b&gt;&lt;br&gt;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;For Any further assist please contact &#34;</span> + $Creatoruser.name + <span style="color:#e6db74">&#34; by Mail: &#34;</span> + $Creatoruser.EmailAddress + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span> 
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;Thanks,&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;ServIT&lt;br&gt;&#34;</span> 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    Send-MailMessage -From $From -to $usersSMTPAddress -Subject $SubjectAdministrators ` -Body $bodyToAD -BodyAsHtml -Encoding UTF8 -SmtpServer $SMTPServer -port $SMTPPort
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#Create email and send it to administrators.</span>
</span></span><span style="display:flex;"><span>    $SubjectAdministrators = <span style="color:#e6db74">&#34;New Service Account Has been Created&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD = <span style="color:#e6db74">&#34;Hello,&lt;br&gt;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;New Service Account has beem created.&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service Account Name:&lt;/b&gt; &#34;</span> + $NewUser.name + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service Account Description:&lt;/b&gt; &#34;</span> + $NewUser.Description + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service Account Managed by:&lt;/b&gt;&#34;</span> + $NewUser.Office + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service Account Created for:&lt;/b&gt; &#34;</span> + $Manageruser.name + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;b&gt;Service Account Created by:&lt;/b&gt;&#34;</span> + $Creatoruser.name + <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;&lt;br&gt;&#34;</span> 
</span></span><span style="display:flex;"><span>    $bodyToAD += <span style="color:#e6db74">&#34;Active Directory Team&lt;br&gt;&#34;</span> 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    Send-MailMessage -From $From -to $AdministratorsSMTPAddress -Subject $SubjectAdministrators ` -Body $bodyToAD -BodyAsHtml -Encoding UTF8 -SmtpServer $SMTPServer -port $SMTPPort
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="create-new-service-account">Create new Service account</h3>
<p>Last but not least, the reason we are here, the Service account creation function.
In this function, we specify the account creation OU, the password and the rest of the attribute needed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#75715e">#Create the Service Account</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> new-ADServiceAccount ($SAName, $Description, $Creatoruser, $Manageruser) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># OU to create the Service Account</span>
</span></span><span style="display:flex;"><span>    $path = <span style="color:#e6db74">&#39;OU=Global Service Accounts,DC=Saggiehaim,DC=net&#39;</span>
</span></span><span style="display:flex;"><span>    $password = new-Password
</span></span><span style="display:flex;"><span>    $ManagedBy = <span style="color:#e6db74">&#39;Managed By &#39;</span> + $Manageruser.Name + <span style="color:#e6db74">&#39; (&#39;</span> + $Manageruser.EmployeeID + <span style="color:#e6db74">&#39;)&#39;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        New-ADUser -SamAccountName $SAName -UserPrincipalName $SAName -DisplayName $SAName -GivenName $SAName -Name $SAName -Description $Description -Office $ManagedBy -AccountPassword (ConvertTo-SecureString -AsPlainText $password -Force) -Enabled $true -ChangePasswordAtLogon $true -Path $path  
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">catch</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $false
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    $NewUser = Get-ADUser -Identity $SAName -Properties Office, Description
</span></span><span style="display:flex;"><span>    Send-DoneEmail $Creatoruser $Manageruser $NewUser $password
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> $true
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="the-script">The Script</h3>
<p>We built the GUI and the functions needed to perform the creation task.
If you remember, when we created the GUI, we add an Action event.
The script we build now is the script we want to execute each time someone presses the key.</p>
<h3 id="content-validation">Content validation</h3>
<p>We will start with content validation, to make sure that the Help Desk operator is following the Service Account creation guideline.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ($SAccountName.Text <span style="color:#f92672">-eq</span> $null <span style="color:#f92672">-or</span> $SAccountName.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">-or</span> $SAccountName.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Srvc&#34;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Make sure you set Service Account name&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elseif</span> ($SAccountName.Text <span style="color:#f92672">-notlike</span> <span style="color:#e6db74">&#34;Srvc*&#34;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Make sure Service Account Name start with &#39;Srvc&#39;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($TDescription.Text <span style="color:#f92672">-eq</span> $null <span style="color:#f92672">-or</span> $TDescription.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">-or</span> $TDescription.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;Service Account For&#34;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Make sure to insert Service Account Description!&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elseif</span> ($TDescription.Text <span style="color:#f92672">-notlike</span> <span style="color:#e6db74">&#34;Service Account For*&#34;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Start Description with &#39;Service Account For&#39;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($ManagerEmployeeID.Text <span style="color:#f92672">-eq</span> $null <span style="color:#f92672">-or</span> $ManagerEmployeeID.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;&#39;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Enter Manager Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($CreatorEmployeeID.Text <span style="color:#f92672">-eq</span> $null <span style="color:#f92672">-or</span> $creatorEmployeeID.Text <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#39;&#39;</span>) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Enter Creator Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        $Creator = Get-account $CreatorEmployeeID.text
</span></span><span style="display:flex;"><span>        $Manager = Get-account $ManagerEmployeeID.text
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($Creator <span style="color:#f92672">-eq</span> $false) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Validate Creator Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> 
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($Manager <span style="color:#f92672">-eq</span> $false) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Please Validate Manager Employee ID&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><h3 id="creating-the-service-account">Creating the Service Account</h3>
<p>Now after we finished with the validations, we can create the Service Account:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>        $run = new-ADServiceAccount $SAccountName.text $TDescription.text $Creator $Manager
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ($run <span style="color:#f92672">-eq</span> $false) {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#ff0000&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Process Failed. Please verify you have permissions&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            $StatusBar.ForeColor = <span style="color:#e6db74">&#34;#00b300&#34;</span>
</span></span><span style="display:flex;"><span>            $StatusBar.Text = <span style="color:#e6db74">&#34;Process Finished with no errors&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>We learned how to build GUI for our PowerShell scripts.
How it can help us help others who don‚Äôt know yet PowerShell.
And even better, give them the motivation to learn PowerShell and maybe even create their own GUI üòâ</p>
<p>I would love to hear your GUI‚Äôs Ideas!</p>
<p>You can see the complete script <a href="https://github.com/Saggiehaim/Powershell/blob/master/New%20Service%20Account/NewServiceAccount.ps1" target="_blank" rel="noopener">here</a>
.</p>

      </article>

      




    </div>
  </div>
</div>

  </main>
  <footer class="flex flex-none justify-center">
    <section class="flex flex-col md:flex-row mx-2 md:mx-0 gap-2 md:gap-0 justify-between w-full max-w-4xl lg:max-w-5xl py-6 text-slate-500 dark:text-slate-300">
  <div class="flex flex-row">
    
  
  
    <a href="https://www.linkedin.com/in/saggie/" target="_blank" title="Linkedin" class="flex flex-row mr-2">
      <span class="hidden">Linkedin</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z"></path>
   <path d="M8 11l0 5"></path>
   <path d="M8 8l0 .01"></path>
   <path d="M12 16l0 -5"></path>
   <path d="M16 16v-3a2 2 0 0 0 -4 0"></path>
</svg>
 </i>
    </a>
  
  
  
    <a href="https://github.com/SaggehaimBlog" target="_blank" title="Github" class="flex flex-row mr-2">
      <span class="hidden">Github</span>
      <i class="h-6 w-6 flex-none"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
</svg>
 </i>
    </a>
  
  


  </div>
  <div class="grow"></div>
  <div class="flex flex-row">
    <i class="h-6 w-6 flex-none"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
   <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
   <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path>
   <path d="M14 9.75a3.016 3.016 0 0 0 -4.163 .173a2.993 2.993 0 0 0 0 4.154a3.016 3.016 0 0 0 4.163 .173"></path>
</svg>
</i> 2018 - 2024 Saggie Haim
    
  </div>
  
</section>

  </footer>
  <script src="/main.js"></script>

<div class="hidden top-1 right-1" id="code-copy">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
  <path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
</svg>

  </i>
</div>
<div class="hidden top-1 right-1" id="code-copy-done">
  <i class="h-6 w-6 block">
    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-check" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M5 12l5 5l10 -10" />
</svg>

  </i>
</div><script src="/code-copy.js"></script>





</body>
</html>
